diff --git a/includes/common.inc b/includes/common.inc
index c6303ef..857151c 100644
--- a/includes/common.inc
+++ b/includes/common.inc
@@ -5513,6 +5513,35 @@ function drupal_system_listing($mask, $directory, $key = 'name', $min_depth = 1)
     $searchdir[] = "$config/$directory";
   }
 
+  // To allow component modules to be discovered in the theme
+  if($directory == 'modules'){
+
+    if(!function_exists('kostym_list_themes')){
+      module_load_include('module', 'kostym');
+    }
+
+    // If current theme is "disabled" (in update.php for example) searchthrough all themes!
+    $only_enabled_themes = $GLOBALS['theme_info']->status;
+
+    foreach(kostym_list_themes($only_enabled_themes) as $theme_info){
+      $component_path = $theme_info->path . '/kostym_components';
+
+      if(is_dir($component_path)){
+        $searchdir[] = $component_path;
+      }
+    }
+  }
+
+  // By default, do not check for files in common special-purpose directories.
+  // The folders here are front-end related and they have been added to avoid
+  // issues with Drupal recursive scanning. In this case, we added node_modules
+  // and bower_components. This also improves performance on frontend builds.
+  $ignore_directories = variable_get('drupal_file_scan_ignore_directories', array(
+    'node_modules',
+    'bower_components',
+  ));
+  $no_mask = '/^(\..*)|' . implode('|', $ignore_directories) . '$/';
+
   // Get current list of items.
   if (!function_exists('file_scan_directory')) {
     require_once DRUPAL_ROOT . '/includes/file.inc';
@@ -5545,6 +5574,15 @@ function drupal_system_listing($mask, $directory, $key = 'name', $min_depth = 1)
     $files = array_merge($files, $files_to_add);
   }
 
+  // Avoid components to be added as themes
+  if($directory == 'themes'){
+    foreach($files as $file_key => $file){
+      if(preg_match('/kostym_components\/' . $file_key . '\/' . $file_key . '\.info$/', $file->uri)){
+        unset($files[$file_key]);
+      }
+    }
+  }
+
   return $files;
 }
 
